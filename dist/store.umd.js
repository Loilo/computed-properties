!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.computedProperties=n()}(this,function(){function e(e){return!(!Array.isArray(e)&&("object"!=typeof e||null===e||e.prototype)||!e.$destroy)}function n(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];if(0===e.length)throw new TypeError("Cannot convert undefined or null to object");if("assign"in Object)return Object.assign.apply(Object,e);if(1===e.length)return e[0];for(var t in e[1])e[0][t]=e[1][t];return n.apply(void 0,[e[0]].concat(e.slice(2)))}function r(u,c){if(e(c))return c;if(Array.isArray(c)){for(var l=c.slice(0),a=0;a<l.length;a++)l[a]=r(u,l[a]);return function(e){for(var n=[],t=arguments.length-1;t-- >0;)n[t]=arguments[t+1];var u=!0,c=[],l=function(){u||e()},a=function(n){return r(e,n)},i=function(e){for(var n,r=[],t=arguments.length-1;t-- >0;)r[t]=arguments[t+1];return(n=Array.prototype[e]).call.apply(n,[c].concat(r))};return Object.defineProperty(c,"push",{value:function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var r=i.apply(void 0,["push"].concat(e.map(a)));return e.length&&l(),r},enumerable:!1}),Object.defineProperty(c,"pop",{value:function(){var e=c.length,n=i("pop");return e&&l(),n},enumerable:!1}),Object.defineProperty(c,"shift",{value:function(){var e=c.length,n=i("shift");return e&&l(),n},enumerable:!1}),Object.defineProperty(c,"unshift",{value:function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var r=i.apply(void 0,["unshift"].concat(e.map(a)));return e.length&&l(),r},enumerable:!1}),Object.defineProperty(c,"splice",{value:function(e,n){for(var r=[],t=arguments.length-2;t-- >0;)r[t]=arguments[t+2];var o=i.apply(void 0,["splice",e,n].concat(r.map(a)));return(o.length||r.length)&&l(),o},enumerable:!1}),Object.defineProperty(c,"sort",{value:function(e){var n=i("sort",e);return l(),n},enumerable:!1}),Object.defineProperty(c,"reverse",{value:function(){var e=i("reverse");return l(),e},enumerable:!1}),Object.defineProperty(c,"$raw",{value:function(){return c.slice(0)},enumerable:!1}),Object.defineProperty(c,"$set",{value:function(e,n){c[e]=a(n),l()},enumerable:!1}),Object.defineProperty(c,"$destroy",{value:function(){return u=!0,c.map(o)},enumerable:!1}),c.push.apply(c,n),u=!1,c}.apply(void 0,[u].concat(l))}if(function(e){return"object"==typeof e&&null!==e&&null==e.prototype}(c)){var i=n({},c);for(var f in i)i[f]=r(u,i[f]);return function(e,o){var u=Object.create(null),c=!0,l=[],a=function(){c||e()};function i(){return Object.getOwnPropertyNames(u).filter(function(e){return"$"!==e[0]}).reduce(function(e,r){var o;return n(Object.create(null),e,((o={})[r]=t(u[r]),o))},Object.create(null))}function f(n,t){if(-1!==l.indexOf(n))throw new Error("Property "+n+" is already defined");var o=t;Object.defineProperty(u,n,{get:function(){return o},set:function(n){var t=n!==o;o=r(e,n),t&&a()},enumerable:!0,configurable:!0}),l.push(n),a()}return Object.defineProperty(u,"$set",{value:function(e,n){f(e,n)},enumerable:!1}),Object.defineProperty(u,"$raw",{value:function(){return i()},enumerable:!1}),Object.defineProperty(u,"$destroy",{value:function(){return c=!0,i()},enumerable:!1}),function(){for(var e=0,n=Object.keys(o);e<n.length;e+=1){var r=n[e];f(r,o[r])}}(),c=!1,u}(u,i)}return c}function t(n){return e(n)?n.$raw():n}function o(n){return e(n)?n.$destroy():n}return function(e,o){void 0===o&&(o={});var u=o.verbose;void 0===u&&(u=!1);var c=Object.create(null),l=!1,a=null,i=Object.create(null),f=Object.create(null),p={},v={},d=Object.create(null),s=Object.keys(e),y=[];function b(e){u&&console.log("  invalidate cache of property",e),p.hasOwnProperty(e)&&(v[e]=p[e],delete p[e]);for(var n=0,r=Object.keys(f[e]);n<r.length;n+=1)b(r[n])}function h(n){var t=r(function(){return b(n)},e[n]);Object.defineProperty(d,n,{get:function(){return u&&console.log("Accessed property",n,"=",t),l&&(u&&console.log("  through tracking of computed property",a),i[a][n]=!0),t},set:function(e){if(e!==t){var o=t;t=r(function(){return b(n)},e),u&&console.log("Set value of property",n,"=",t),u&&console.log("  dependencies to notify:",Object.keys(f[n]));for(var l=0,a=Object.keys(f[n]);l<a.length;l+=1)b(a[l]);c[n]&&c[n].forEach(function(e){return e(t,o)})}}})}function g(n){var r=[];Object.defineProperty(d,n,{get:function(){if(u&&console.log("Accessed computed property",n),l&&(u&&console.log("  through tracking of computed property",a),i[a][n]=!0),p.hasOwnProperty(n))return u&&console.log("  got it from cache"),p[n];var t=v.hasOwnProperty(n);u&&console.log(t?"  it had already been changed":"  it has never been changed before");for(var o=function(n){var r=l,t=a;l=!0,a=n,i[n]=Object.create(null);var o=e[n].call(d,d),u=Object.keys(i[n]||Object.create(null));return delete i[n],r?a=t:l=!1,{dependencies:u,value:o}}(n),s=o.dependencies,y=0,b=r;y<b.length;y+=1)delete f[b[y]][n];for(var h=0,g=s;h<g.length;h+=1)f[g[h]][n]=!0;return r=o.dependencies,u&&console.log("  re-evaluated the computed property"),u&&console.log("    dependencies:",r),u&&console.log("    new value:",o.value),p[n]=o.value,t&&v[n]!==o.value&&c[n]&&c[n].forEach(function(e){return e(o.value,v[n])}),t&&delete v[n],o.value}})}return function(){for(var r=0,o=s;r<o.length;r+=1){var u=o[r];f[u]=Object.create(null),"function"==typeof e[u]?(g(u),y.push(u)):h(u)}return Object.defineProperty(d,"$raw",{value:function(e){return void 0===e&&(e=!0),function(e){return Object.getOwnPropertyNames(d).filter(function(n){return"$"!==n[0]&&(e||-1===y.indexOf(n))}).reduce(function(e,r){var o;return n(Object.create(null),e,((o={})[r]=t(d[r]),o))},Object.create(null))}(e)},enumerable:!1}),Object.defineProperty(d,"$watch",{value:function(e,n){return e in c||(c[e]=[]),c[e].push(n),function(){c[e].splice(c[e].indexOf(n),1),c[e].length||delete c[e]}},enumerable:!1}),d}()}});
//# sourceMappingURL=store.umd.js.map
