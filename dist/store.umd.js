!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.computedProperties=n()}(this,function(){function e(e){return!(!Array.isArray(e)&&("object"!=typeof e||null===e||e.prototype)||!e.$destroy)}function n(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];if(0===e.length)throw new TypeError("Cannot convert undefined or null to object");if("assign"in Object)return Object.assign.apply(Object,e);if(1===e.length)return e[0];for(var t in e[1])e[0][t]=e[1][t];return n.apply(void 0,[e[0]].concat(e.slice(2)))}function r(u,c){if(e(c))return c;if(Array.isArray(c)){for(var l=c.slice(0),a=0;a<l.length;a++)l[a]=r(u,l[a]);return function(e){for(var n=[],t=arguments.length-1;t-- >0;)n[t]=arguments[t+1];var u=!0,c=[],l=function(){u||e()},a=function(n){return r(e,n)},i=function(e){for(var n,r=[],t=arguments.length-1;t-- >0;)r[t]=arguments[t+1];return(n=Array.prototype[e]).call.apply(n,[c].concat(r))};return Object.defineProperty(c,"push",{value:function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var r=i.apply(void 0,["push"].concat(e.map(a)));return e.length&&l(),r},enumerable:!1}),Object.defineProperty(c,"pop",{value:function(){var e=c.length,n=i("pop");return e&&l(),n},enumerable:!1}),Object.defineProperty(c,"shift",{value:function(){var e=c.length,n=i("shift");return e&&l(),n},enumerable:!1}),Object.defineProperty(c,"unshift",{value:function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var r=i.apply(void 0,["unshift"].concat(e.map(a)));return e.length&&l(),r},enumerable:!1}),Object.defineProperty(c,"splice",{value:function(e,n){for(var r=[],t=arguments.length-2;t-- >0;)r[t]=arguments[t+2];var o=i.apply(void 0,["splice",e,n].concat(r.map(a)));return(o.length||r.length)&&l(),o},enumerable:!1}),Object.defineProperty(c,"sort",{value:function(e){var n=i("sort",e);return l(),n},enumerable:!1}),Object.defineProperty(c,"reverse",{value:function(){var e=i("reverse");return l(),e},enumerable:!1}),Object.defineProperty(c,"$raw",{value:function(){return c.slice(0)},enumerable:!1}),Object.defineProperty(c,"$set",{value:function(e,n){c[e]=a(n),l()},enumerable:!1}),Object.defineProperty(c,"$destroy",{value:function(){return u=!0,c.map(o)},enumerable:!1}),c.push.apply(c,n),u=!1,c}.apply(void 0,[u].concat(l))}if(function(e){return"object"==typeof e&&null!==e&&null==e.prototype}(c)){var i=n({},c);for(var f in i)i[f]=r(u,i[f]);return function(e,o){var u=Object.create(null),c=!0,l=[],a=function(){c||e()};function i(){return Object.getOwnPropertyNames(u).filter(function(e){return"$"!==e[0]}).reduce(function(e,r){var o;return n(Object.create(null),e,((o={})[r]=t(u[r]),o))},Object.create(null))}function f(n,t){if(-1!==l.indexOf(n))throw new Error("Property "+n+" is already defined");var o=t;Object.defineProperty(u,n,{get:function(){return o},set:function(n){var t=n!==o;o=r(e,n),t&&a()},enumerable:!0,configurable:!0}),l.push(n),a()}return Object.defineProperty(u,"$set",{value:function(e,n){f(e,n)},enumerable:!1}),Object.defineProperty(u,"$raw",{value:function(){return i()},enumerable:!1}),Object.defineProperty(u,"$destroy",{value:function(){return c=!0,i()},enumerable:!1}),function(){for(var e=0,n=Object.keys(o);e<n.length;e+=1){var r=n[e];f(r,o[r])}}(),c=!1,u}(u,i)}return c}function t(n){return e(n)?n.$raw():n}function o(n){return e(n)?n.$destroy():n}var u=Reflect?Reflect.get:function(e,n){return e[n]};return function(e,o){void 0===o&&(o={});var c=o.verbose;void 0===c&&(c=!1);var l=Object.create(null),a=!1,i=null,f=Object.create(null),p=Object.create(null),v={},d={},s=Object.create(null),y=Object.keys(e),b=[];function g(e){c&&console.log("  invalidate cache of property",e),v.hasOwnProperty(e)&&(d[e]=v[e],delete v[e]),l[e]&&u(s,e);for(var n=0,r=Object.keys(p[e]);n<r.length;n+=1)g(r[n])}function h(n){c&&console.log("Define static property",n);var t=r(function(){return g(n)},e[n]);Object.defineProperty(s,n,{get:function(){return c&&console.log("Accessed property",n,"=",t),a&&(c&&console.log("  through tracking of computed property",i),f[i][n]=!0),t},set:function(e){if(e!==t){var o=t;t=r(function(){return g(n)},e),c&&console.log("Set value of property",n,"=",t),c&&console.log("  dependencies to notify:",Object.keys(p[n]));for(var u=0,a=Object.keys(p[n]);u<a.length;u+=1)g(a[u]);l[n]&&l[n].forEach(function(e){return e(t,o)})}}})}function O(n){c&&console.log("Define computed property",n);var r=[];Object.defineProperty(s,n,{get:function(){if(c&&console.log("Accessed computed property",n),a&&(c&&console.log("  through tracking of computed property",i),f[i][n]=!0),v.hasOwnProperty(n))return c&&console.log("  got it from cache"),v[n];var t=d.hasOwnProperty(n);c&&console.log(t?"  it had already been changed":"  it has never been changed before");for(var o=function(n){var r=a,t=i;a=!0,i=n,f[n]=Object.create(null);var o=e[n].call(s,s),u=Object.keys(f[n]||Object.create(null));return delete f[n],r?i=t:a=!1,{dependencies:u,value:o}}(n),u=o.dependencies,y=0,b=r;y<b.length;y+=1)delete p[b[y]][n];for(var g=0,h=u;g<h.length;g+=1)p[h[g]][n]=!0;return r=o.dependencies,c&&console.log("  re-evaluated the computed property"),c&&console.log("    dependencies:",r),c&&console.log("    new value:",o.value),v[n]=o.value,t&&d[n]!==o.value&&l[n]&&l[n].forEach(function(e){return e(o.value,d[n])}),t&&delete d[n],o.value}})}return function(){for(var r=0,o=y;r<o.length;r+=1){var c=o[r];p[c]=Object.create(null),"function"==typeof e[c]?(O(c),b.push(c)):h(c)}return Object.defineProperty(s,"$raw",{value:function(e){return void 0===e&&(e=!0),function(e){return Object.getOwnPropertyNames(s).filter(function(n){return"$"!==n[0]&&(e||-1===b.indexOf(n))}).reduce(function(e,r){var o;return n(Object.create(null),e,((o={})[r]=t(s[r]),o))},Object.create(null))}(e)},enumerable:!1}),Object.defineProperty(s,"$watch",{value:function(e,n){return e in l||(l[e]=[],u(s,e)),l[e].push(n),function(){l[e].splice(l[e].indexOf(n),1),l[e].length||delete l[e]}},enumerable:!1}),s}()}});
//# sourceMappingURL=store.umd.js.map
